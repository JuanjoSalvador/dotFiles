(function() {
  module.exports = function(colorPicker) {
    return {
      Emitter: (require('../modules/Emitter'))(),
      element: null,
      color: null,
      emitVisibility: function(visible) {
        if (visible == null) {
          visible = true;
        }
        return this.Emitter.emit('visible', visible);
      },
      onVisibility: function(callback) {
        return this.Emitter.on('visible', callback);
      },
      activate: function() {
        var View, _isClicking, hasChild;
        View = this;
        this.element = {
          el: (function() {
            var _classPrefix, _el;
            _classPrefix = colorPicker.element.el.className;
            _el = document.createElement('div');
            _el.classList.add(_classPrefix + "-return");
            return _el;
          })(),
          addClass: function(className) {
            this.el.classList.add(className);
            return this;
          },
          removeClass: function(className) {
            this.el.classList.remove(className);
            return this;
          },
          hasClass: function(className) {
            return this.el.classList.contains(className);
          },
          hide: function() {
            this.removeClass('is--visible');
            return View.emitVisibility(false);
          },
          show: function() {
            this.addClass('is--visible');
            return View.emitVisibility(true);
          },
          add: function(element) {
            this.el.appendChild(element);
            return this;
          },
          setColor: function(smartColor) {
            return this.el.style.backgroundColor = smartColor.toRGBA();
          }
        };
        colorPicker.element.add(this.element.el);
        hasChild = function(element, child) {
          var _parent;
          if (child && (_parent = child.parentNode)) {
            if (child === element) {
              return true;
            } else {
              return hasChild(element, _parent);
            }
          }
          return false;
        };
        _isClicking = false;
        colorPicker.onMouseDown((function(_this) {
          return function(e, isOnPicker) {
            if (!(isOnPicker && hasChild(_this.element.el, e.target))) {
              return;
            }
            e.preventDefault();
            return _isClicking = true;
          };
        })(this));
        colorPicker.onMouseMove(function(e) {
          return _isClicking = false;
        });
        colorPicker.onMouseUp((function(_this) {
          return function(e) {
            if (!(_isClicking && _this.color)) {
              return;
            }
            return colorPicker.emitInputColor(_this.color);
          };
        })(this));
        setTimeout((function(_this) {
          return function() {
            var Alpha;
            Alpha = colorPicker.getExtension('Alpha');
            colorPicker.onBeforeOpen(function() {
              return _this.color = null;
            });
            colorPicker.onInputColor(function(smartColor, wasFound) {
              if (wasFound) {
                return _this.color = smartColor;
              }
            });
            Alpha.onColorChanged(function(smartColor) {
              if (!_this.color) {
                return _this.element.hide();
              }
              if (smartColor.equals(_this.color)) {
                return _this.element.hide();
              } else {
                return _this.element.show();
              }
            });
          };
        })(this));
        setTimeout((function(_this) {
          return function() {
            colorPicker.onInputColor(function(smartColor, wasFound) {
              if (wasFound) {
                return _this.element.setColor(smartColor);
              }
            });
          };
        })(this));
        setTimeout((function(_this) {
          return function() {
            var _text, setColor;
            _text = document.createElement('p');
            _text.classList.add(_this.element.el.className + "-text");
            setColor = function(smartColor) {
              return _text.innerText = smartColor.value;
            };
            colorPicker.onInputColor(function(smartColor, wasFound) {
              if (wasFound) {
                return setColor(smartColor);
              }
            });
            return _this.element.add(_text);
          };
        })(this));
        return this;
      }
    };
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiL2hvbWUvanVhbmpvLy5hdG9tL3BhY2thZ2VzL2NvbG9yLXBpY2tlci9saWIvZXh0ZW5zaW9ucy9SZXR1cm4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU1JO0VBQUEsTUFBTSxDQUFDLE9BQVAsR0FBaUIsU0FBQyxXQUFEO1dBQ2I7TUFBQSxPQUFBLEVBQVMsQ0FBQyxPQUFBLENBQVEsb0JBQVIsQ0FBRCxDQUFBLENBQUEsQ0FBVDtNQUVBLE9BQUEsRUFBUyxJQUZUO01BR0EsS0FBQSxFQUFPLElBSFA7TUFTQSxjQUFBLEVBQWdCLFNBQUMsT0FBRDs7VUFBQyxVQUFROztlQUNyQixJQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBYyxTQUFkLEVBQXlCLE9BQXpCO01BRFksQ0FUaEI7TUFXQSxZQUFBLEVBQWMsU0FBQyxRQUFEO2VBQ1YsSUFBQyxDQUFBLE9BQU8sQ0FBQyxFQUFULENBQVksU0FBWixFQUF1QixRQUF2QjtNQURVLENBWGQ7TUFpQkEsUUFBQSxFQUFVLFNBQUE7QUFDTixZQUFBO1FBQUEsSUFBQSxHQUFPO1FBSVAsSUFBQyxDQUFBLE9BQUQsR0FDSTtVQUFBLEVBQUEsRUFBTyxDQUFBLFNBQUE7QUFDSCxnQkFBQTtZQUFBLFlBQUEsR0FBZSxXQUFXLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztZQUN0QyxHQUFBLEdBQU0sUUFBUSxDQUFDLGFBQVQsQ0FBdUIsS0FBdkI7WUFDTixHQUFHLENBQUMsU0FBUyxDQUFDLEdBQWQsQ0FBc0IsWUFBRixHQUFnQixTQUFwQztBQUVBLG1CQUFPO1VBTEosQ0FBQSxDQUFILENBQUEsQ0FBSjtVQU9BLFFBQUEsRUFBVSxTQUFDLFNBQUQ7WUFBZSxJQUFDLENBQUEsRUFBRSxDQUFDLFNBQVMsQ0FBQyxHQUFkLENBQWtCLFNBQWxCO0FBQTZCLG1CQUFPO1VBQW5ELENBUFY7VUFRQSxXQUFBLEVBQWEsU0FBQyxTQUFEO1lBQWUsSUFBQyxDQUFB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LENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBQSxFQURKO2VBQUEsTUFBQTt1QkFFSyxLQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBQSxFQUZMOztZQUhpQixDQUFyQjtVQVpPO1FBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFYO1FBc0JBLFVBQUEsQ0FBVyxDQUFBLFNBQUEsS0FBQTtpQkFBQSxTQUFBO1lBQ1AsV0FBVyxDQUFDLFlBQVosQ0FBeUIsU0FBQyxVQUFELEVBQWEsUUFBYjtjQUNyQixJQUFnQyxRQUFoQzt1QkFBQSxLQUFDLENBQUEsT0FBTyxDQUFDLFFBQVQsQ0FBa0IsVUFBbEIsRUFBQTs7WUFEcUIsQ0FBekI7VUFETztRQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBWDtRQU9BLFVBQUEsQ0FBVyxDQUFBLFNBQUEsS0FBQTtpQkFBQSxTQUFBO0FBRVAsZ0JBQUE7WUFBQSxLQUFBLEdBQVEsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsR0FBdkI7WUFDUixLQUFLLENBQUMsU0FBUyxDQUFDLEdBQWhCLENBQXdCLEtBQUMsQ0FBQSxPQUFPLENBQUMsRUFBRSxDQUFDLFNBQWQsR0FBeUIsT0FBL0M7WUFHQSxRQUFBLEdBQVcsU0FBQyxVQUFEO3FCQUNQLEtBQUssQ0FBQyxTQUFOLEdBQWtCLFVBQVUsQ0FBQztZQUR0QjtZQUdYLFdBQVcsQ0FBQyxZQUFaLENBQXlCLFNBQUMsVUFBRCxFQUFhLFFBQWI7Y0FDckIsSUFBdUIsUUFBdkI7dUJBQUEsUUFBQSxDQUFTLFVBQVQsRUFBQTs7WUFEcUIsQ0FBekI7bUJBRUEsS0FBQyxDQUFBLE9BQU8sQ0FBQyxHQUFULENBQWEsS0FBYjtVQVhPO1FBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFYO0FBWUEsZUFBTztNQWhHRCxDQWpCVjs7RUFEYTtBQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyAgQ29sb3IgUGlja2VyL2V4dGVuc2lvbnM6IFJldHVyblxuIyAgVGhlIGVsZW1lbnQgc2hvd2luZyB0aGUgaW5pdGlhbCBjb2xvciB2YWx1ZSwgZW5hYmxpbmcgdGhlIHVzZXIgdG8gcmV0dXJuXG4jICB0byBpdCBhdCBhbnkgdGltZVxuIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IChjb2xvclBpY2tlcikgLT5cbiAgICAgICAgRW1pdHRlcjogKHJlcXVpcmUgJy4uL21vZHVsZXMvRW1pdHRlcicpKClcblxuICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgIGNvbG9yOiBudWxsXG5cbiAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAjICBTZXQgdXAgZXZlbnRzIGFuZCBoYW5kbGluZ1xuICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAjIFZpc2liaWxpdHkgZXZlbnRcbiAgICAgICAgZW1pdFZpc2liaWxpdHk6ICh2aXNpYmxlPXRydWUpIC0+XG4gICAgICAgICAgICBARW1pdHRlci5lbWl0ICd2aXNpYmxlJywgdmlzaWJsZVxuICAgICAgICBvblZpc2liaWxpdHk6IChjYWxsYmFjaykgLT5cbiAgICAgICAgICAgIEBFbWl0dGVyLm9uICd2aXNpYmxlJywgY2FsbGJhY2tcblxuICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICMgIENyZWF0ZSBhbmQgYWN0aXZhdGUgUmV0dXJuIGVsZW1lbnRcbiAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgYWN0aXZhdGU6IC0+XG4gICAgICAgICAgICBWaWV3ID0gdGhpc1xuXG4gICAgICAgICMgIEJ1aWxkIHRoZSBlbGVtZW50XG4gICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBAZWxlbWVudCA9XG4gICAgICAgICAgICAgICAgZWw6IGRvIC0+XG4gICAgICAgICAgICAgICAgICAgIF9jbGFzc1ByZWZpeCA9IGNvbG9yUGlja2VyLmVsZW1lbnQuZWwuY2xhc3NOYW1lXG4gICAgICAgICAgICAgICAgICAgIF9lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgJ2RpdidcbiAgICAgICAgICAgICAgICAgICAgX2VsLmNsYXNzTGlzdC5hZGQgXCIjeyBfY2xhc3NQcmVmaXggfS1yZXR1cm5cIlxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfZWxcbiAgICAgICAgICAgICAgICAjIFV0aWxpdHkgZnVuY3Rpb25zXG4gICAgICAgICAgICAgICAgYWRkQ2xhc3M6IChjbGFzc05hbWUpIC0+IEBlbC5jbGFzc0xpc3QuYWRkIGNsYXNzTmFtZTsgcmV0dXJuIHRoaXNcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzczogKGNsYXNzTmFtZSkgLT4gQGVsLmNsYXNzTGlzdC5yZW1vdmUgY2xhc3NOYW1lOyByZXR1cm4gdGhpc1xuICAgICAgICAgICAgICAgIGhhc0NsYXNzOiAoY2xhc3NOYW1lKSAtPiBAZWwuY2xhc3NMaXN0LmNvbnRhaW5zIGNsYXNzTmFtZVxuXG4gICAgICAgICAgICAgICAgaGlkZTogLT4gQHJlbW92ZUNsYXNzICdpcy0tdmlzaWJsZSc7IFZpZXcuZW1pdFZpc2liaWxpdHkgZmFsc2VcbiAgICAgICAgICAgICAgICBzaG93OiAtPiBAYWRkQ2xhc3MgJ2lzLS12aXNpYmxlJzsgVmlldy5lbWl0VmlzaWJpbGl0eSB0cnVlXG5cbiAgICAgICAgICAgICAgICAjIEFkZCBhIGNoaWxkIG9uIHRoZSBSZXR1cm4gZWxlbWVudFxuICAgICAgICAgICAgICAgIGFkZDogKGVsZW1lbnQpIC0+XG4gICAgICAgICAgICAgICAgICAgIEBlbC5hcHBlbmRDaGlsZCBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXG5cbiAgICAgICAgICAgICAgICAjIFNldCB0aGUgUmV0dXJuIGVsZW1lbnQgYmFja2dyb3VuZCBjb2xvclxuICAgICAgICAgICAgICAgIHNldENvbG9yOiAoc21hcnRDb2xvcikgLT5cbiAgICAgICAgICAgICAgICAgICAgQGVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHNtYXJ0Q29sb3IudG9SR0JBKClcbiAgICAgICAgICAgIGNvbG9yUGlja2VyLmVsZW1lbnQuYWRkIEBlbGVtZW50LmVsXG5cbiAgICAgICAgIyAgUmV0dXJuIGNvbG9yIG9uIGNsaWNrXG4gICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBoYXNDaGlsZCA9IChlbGVtZW50LCBjaGlsZCkgLT5cbiAgICAgICAgICAgICAgICBpZiBjaGlsZCBhbmQgX3BhcmVudCA9IGNoaWxkLnBhcmVudE5vZGVcbiAgICAgICAgICAgICAgICAgICAgaWYgY2hpbGQgaXMgZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gaGFzQ2hpbGQgZWxlbWVudCwgX3BhcmVudFxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuXG4gICAgICAgICAgICBfaXNDbGlja2luZyA9IG5vXG5cbiAgICAgICAgICAgIGNvbG9yUGlja2VyLm9uTW91c2VEb3duIChlLCBpc09uUGlja2VyKSA9PlxuICAgICAgICAgICAgICAgIHJldHVybiB1bmxlc3MgaXNPblBpY2tlciBhbmQgaGFzQ2hpbGQgQGVsZW1lbnQuZWwsIGUudGFyZ2V0XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICAgICAgX2lzQ2xpY2tpbmcgPSB5ZXNcblxuICAgICAgICAgICAgY29sb3JQaWNrZXIub25Nb3VzZU1vdmUgKGUpIC0+XG4gICAgICAgICAgICAgICAgX2lzQ2xpY2tpbmcgPSBub1xuXG4gICAgICAgICAgICBjb2xvclBpY2tlci5vbk1vdXNlVXAgKGUpID0+XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVubGVzcyBfaXNDbGlja2luZyBhbmQgQGNvbG9yXG4gICAgICAgICAgICAgICAgY29sb3JQaWNrZXIuZW1pdElucHV0Q29sb3IgQGNvbG9yXG5cbiAgICAgICAgIyAgU2hvdyB0aGUgZWxlbWVudCB3aGVuIHRoZSBpbnB1dCBjb2xvciBpc24ndCB0aGUgY3VycmVudCBjb2xvclxuICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgc2V0VGltZW91dCA9PlxuICAgICAgICAgICAgICAgIEFscGhhID0gY29sb3JQaWNrZXIuZ2V0RXh0ZW5zaW9uICdBbHBoYSdcblxuICAgICAgICAgICAgICAgICMgUmVzZXQgb24gY29sb3JQaWNrZXIgb3BlblxuICAgICAgICAgICAgICAgIGNvbG9yUGlja2VyLm9uQmVmb3JlT3BlbiA9PlxuICAgICAgICAgICAgICAgICAgICBAY29sb3IgPSBudWxsXG5cbiAgICAgICAgICAgICAgICAjIFNhdmUgdGhlIGN1cnJlbnQgY29sb3JcbiAgICAgICAgICAgICAgICBjb2xvclBpY2tlci5vbklucHV0Q29sb3IgKHNtYXJ0Q29sb3IsIHdhc0ZvdW5kKSA9PlxuICAgICAgICAgICAgICAgICAgICBAY29sb3IgPSBzbWFydENvbG9yIGlmIHdhc0ZvdW5kXG5cbiAgICAgICAgICAgICAgICAjIERvIHRoZSBjaGVjayBvbiBBbHBoYSBjaGFuZ2VcbiAgICAgICAgICAgICAgICBBbHBoYS5vbkNvbG9yQ2hhbmdlZCAoc21hcnRDb2xvcikgPT5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEBlbGVtZW50LmhpZGUoKSB1bmxlc3MgQGNvbG9yXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgc21hcnRDb2xvci5lcXVhbHMgQGNvbG9yXG4gICAgICAgICAgICAgICAgICAgICAgICBAZWxlbWVudC5oaWRlKClcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBAZWxlbWVudC5zaG93KClcbiAgICAgICAgICAgICAgICByZXR1cm5cblxuICAgICAgICAjICBTZXQgYmFja2dyb3VuZCBlbGVtZW50IGNvbG9yIG9uIGlucHV0IGNvbG9yXG4gICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBzZXRUaW1lb3V0ID0+XG4gICAgICAgICAgICAgICAgY29sb3JQaWNrZXIub25JbnB1dENvbG9yIChzbWFydENvbG9yLCB3YXNGb3VuZCkgPT5cbiAgICAgICAgICAgICAgICAgICAgQGVsZW1lbnQuc2V0Q29sb3Igc21hcnRDb2xvciBpZiB3YXNGb3VuZFxuICAgICAgICAgICAgICAgIHJldHVyblxuXG4gICAgICAgICMgIENyZWF0ZSBSZXR1cm4gdGV4dCBlbGVtZW50XG4gICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBzZXRUaW1lb3V0ID0+XG4gICAgICAgICAgICAgICAgIyBDcmVhdGUgdGV4dCBlbGVtZW50XG4gICAgICAgICAgICAgICAgX3RleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50ICdwJ1xuICAgICAgICAgICAgICAgIF90ZXh0LmNsYXNzTGlzdC5hZGQgXCIjeyBAZWxlbWVudC5lbC5jbGFzc05hbWUgfS10ZXh0XCJcblxuICAgICAgICAgICAgICAgICMgU2V0IHRoZSB0ZXh0IGVsZW1lbnQgdG8gY29udGFpbiB0aGUgUmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICBzZXRDb2xvciA9IChzbWFydENvbG9yKSA9PlxuICAgICAgICAgICAgICAgICAgICBfdGV4dC5pbm5lclRleHQgPSBzbWFydENvbG9yLnZhbHVlXG5cbiAgICAgICAgICAgICAgICBjb2xvclBpY2tlci5vbklucHV0Q29sb3IgKHNtYXJ0Q29sb3IsIHdhc0ZvdW5kKSAtPlxuICAgICAgICAgICAgICAgICAgICBzZXRDb2xvciBzbWFydENvbG9yIGlmIHdhc0ZvdW5kXG4gICAgICAgICAgICAgICAgQGVsZW1lbnQuYWRkIF90ZXh0XG4gICAgICAgICAgICByZXR1cm4gdGhpc1xuIl19
